<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Openwrt防检测固件使用教程—PC端</title>
      <link href="/2024/11/08/My-New-Post/"/>
      <url>/2024/11/08/My-New-Post/</url>
      
        <content type="html"><![CDATA[<h1 id="Openwrt实现校园网防检测"><a href="#Openwrt实现校园网防检测" class="headerlink" title="Openwrt实现校园网防检测"></a>Openwrt实现校园网防检测</h1><p><img src="https://bd076fc.webp.li/2024/11/88e47729ebe964e265c5347cf732f6ef.png" alt="https://bd076fc.webp.li/2024/11/88e47729ebe964e265c5347cf732f6ef.png"></p><p>自编译<em>Xiaomi Redmi Router AC2100</em>路由器固件，可用于<strong>STBU校园网</strong>防检测等功能。</p><p>本文将对新拿到已刷好固件的朋友们出一期详细的<strong>PC端</strong>配置教程，方便大家使用到更多功能。</p><div class="note danger simple"><p>Danger 请低调使用本路由器，最好放在不显眼的位置，否则后果自负</p></div><h2 id="1-固件构成"><a href="#1-固件构成" class="headerlink" title="1.  固件构成"></a>1.  固件构成</h2><h3 id="1-1-检测类型"><a href="#1-1-检测类型" class="headerlink" title="1.1 检测类型"></a>1.1 检测类型</h3><p>​            1.基于 IPv4 数据包包头内的 <em>TTL 字段</em>的检测（固定TTL）</p><p>​            2.基于 HTTP 数据包请求头内的 <em>User-Agent 字段</em>的检测(使用UA2F)</p><p>​            3.基于 IPv4 数据包包头内的 <em>Identification 字段</em>的检测（rkp-ipid 设置 IPID）</p><p>​            4.基于网络协议栈时钟偏移的检测技术（统一时间）</p><p>​            本人测试第2、3条检测STBU好像没有，但是以防万一我还是加在里面了。*</p><h3 id="1-2-本固件集成的软件包-部分"><a href="#1-2-本固件集成的软件包-部分" class="headerlink" title="1.2 本固件集成的软件包(部分)"></a>1.2 本固件集成的软件包(部分)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">luci-app-ttyd luci-app-timedreboot luci-app-argon-config kmod-rkp-ipid iptables-mod-filter iptables-mod-ipopt iptables-mod-u32 iptables-nft ua2f luci-app-ua2f kmod-ipt-u32 kmod-ipt-ipopt ipset iptables-mod-conntrack-extra luci-compat luci-theme-argon</span><br></pre></td></tr></table></figure><h2 id="2-固件基础使用教程"><a href="#2-固件基础使用教程" class="headerlink" title="2. 固件基础使用教程"></a>2. 固件基础使用教程</h2><h3 id="2-1-路由器启动和接入网线"><a href="#2-1-路由器启动和接入网线" class="headerlink" title="2.1 路由器启动和接入网线"></a>2.1 路由器启动和接入网线</h3><p>​        先连接电源线，<strong>不要连接网线</strong>，等待路由器灯<strong>从蓝变黄闪再变蓝</strong></p><p>​        通过后面<em>2.2—2.6</em>的设置完成后，再接入已连接校园网的网线到<strong>wan口</strong> <em>（靠近电源线的口）</em></p><h3 id="2-2-进入固件后台管理地址192-168-1-1"><a href="#2-2-进入固件后台管理地址192-168-1-1" class="headerlink" title="2.2 进入固件后台管理地址192.168.1.1"></a>2.2 进入固件后台管理地址192.168.1.1</h3><p>​        推荐使用edge浏览器</p><p><img src="https://bd076fc.webp.li/2024/11/5bc3b473bf7cf6e5a99928eeced8f62a.png" alt="https://bd076fc.webp.li/2024/11/5bc3b473bf7cf6e5a99928eeced8f62a.png"></p><h3 id="2-3-授权进入"><a href="#2-3-授权进入" class="headerlink" title="2.3 授权进入"></a>2.3 授权进入</h3><p>​        默认用户名为root</p><p>​        密码为password</p><p><img src="https://bd076fc.webp.li/2024/11/e96d075286198f95306f212a508a6a40.png" alt="https://bd076fc.webp.li/2024/11/e96d075286198f95306f212a508a6a40.png"></p><h3 id="2-4-进入Openwrt主界面简介"><a href="#2-4-进入Openwrt主界面简介" class="headerlink" title="2.4 进入Openwrt主界面简介"></a>2.4 进入Openwrt主界面简介</h3><p>​        概览含一些路由的基本信息</p><p><img src="https://bd076fc.webp.li/2024/11/599c282dd5cb5e45e99283346ca4a2de.png" alt="https://bd076fc.webp.li/2024/11/599c282dd5cb5e45e99283346ca4a2de.png"></p><p>​        往下可以看见当前在线的用户数量和连接WiFi的主机名及IP地址</p><p><img src="https://bd076fc.webp.li/2024/11/2774c65c3f77d1601b3afcdf47b21741.png"></p><h3 id="2-5-检查基本设置"><a href="#2-5-检查基本设置" class="headerlink" title="2.5 检查基本设置"></a>2.5 检查基本设置</h3><p>​        进入系统，查看本地时间是否和浏览器一致，不一致请<strong>同步浏览器时间</strong></p><p><img src="https://bd076fc.webp.li/2024/11/f2a7906c54d8585096a71f4fd293d5c4.png"></p><p>​        管理权可以更改后台登录密码，<strong>不建议修改</strong>，忘记密码后果自负</p><p><img src="https://bd076fc.webp.li/2024/11/6e3fe828ed53138f84450be903f6cccf.png"></p><p>​        可以选择一个特定时间<strong>定时重启</strong>，让路由器每天可以休息几十秒</p><p><img src="https://bd076fc.webp.li/2024/11/6817bc9a2c5c2ff2b86f489f41e0e0fd.png" alt="https://bd076fc.webp.li/2024/11/6817bc9a2c5c2ff2b86f489f41e0e0fd.png"></p><p>​        后台有<strong>重启按钮</strong>，可以不用去拔电源了</p><p><img src="https://bd076fc.webp.li/2024/11/de41333db5aa52b72b1d829f780ecf6c.png"></p><p>​        服务里带有<strong>U2F检测开关</strong>，实测关了也没有被检测，以防万一还是打开吧</p><p>​        <em>只应用前三个就行</em></p><p><img src="https://bd076fc.webp.li/2024/11/c501485d173ffbf882ac8414e3e51ba6.png"></p><p>​        网络-无线，设置WiFi名称和密码，上面是2.4G，下面是5G，点基本设置进入</p><p><img src="https://bd076fc.webp.li/2024/11/ba584e4e54f5b68ef396b813c4dcf58f.png"></p><p>​        优先<strong>使用5G信号</strong>，本人200M宽带能跑到260M左右</p><p>​        SSID设置WiFi名，密码栏设置WiFi密码，图片是5G信号设置，2.4G不用也要进去设置</p><p><img src="https://bd076fc.webp.li/2024/11/7eac2411986fbe1da41dd07f7d2539c1.png"></p><p>​        检查防火墙-自定义规则代码是否一致，修改后重启防火墙</p><p><img src="https://bd076fc.webp.li/2024/11/4da7adcead1e1c8b60934f9a7ee596ee.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># This file is interpreted as shell script.</span><br><span class="line"># Put your custom iptables rules here, they will</span><br><span class="line"># be executed with each firewall (re-)start.</span><br><span class="line"></span><br><span class="line"># Internal uci firewall chains are flushed and recreated on reload, so</span><br><span class="line"># put custom rules into the root chains e.g. INPUT or FORWARD or into the</span><br><span class="line"># special user chains, e.g. input_wan_rule or postrouting_lan_rule.</span><br><span class="line">#</span><br><span class="line"># 通过 rkp-ipid 设置 IPID</span><br><span class="line">iptables -t mangle -N IPID_MOD</span><br><span class="line">iptables -t mangle -A FORWARD -j IPID_MOD</span><br><span class="line">iptables -t mangle -A OUTPUT -j IPID_MOD</span><br><span class="line">iptables -t mangle -A IPID_MOD -d 0.0.0.0/8 -j RETURN</span><br><span class="line">iptables -t mangle -A IPID_MOD -d 127.0.0.0/8 -j RETURN</span><br><span class="line">iptables -t mangle -A IPID_MOD -d 172.16.0.0/12 -j RETURN</span><br><span class="line">iptables -t mangle -A IPID_MOD -d 192.168.0.0/16 -j RETURN</span><br><span class="line">iptables -t mangle -A IPID_MOD -d 255.0.0.0/8 -j RETURN</span><br><span class="line">iptables -t mangle -A IPID_MOD -j MARK --set-xmark 0x10/0x10</span><br><span class="line"></span><br><span class="line"># 防时钟偏移检测</span><br><span class="line">iptables -t nat -N ntp_force_local</span><br><span class="line">iptables -t nat -I PREROUTING -p udp --dport 123 -j ntp_force_local</span><br><span class="line">iptables -t nat -A ntp_force_local -d 0.0.0.0/8 -j RETURN</span><br><span class="line">iptables -t nat -A ntp_force_local -d 127.0.0.0/8 -j RETURN</span><br><span class="line">iptables -t nat -A ntp_force_local -d 192.168.0.0/16 -j RETURN</span><br><span class="line">iptables -t nat -A ntp_force_local -s 192.168.0.0/16 -j DNAT --to-destination 192.168.1.1</span><br><span class="line"></span><br><span class="line"># 通过 iptables 修改 TTL 值</span><br><span class="line">iptables -t mangle -A POSTROUTING -j TTL --ttl-set 128</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-6-高级功能扩展"><a href="#2-6-高级功能扩展" class="headerlink" title="2.6 高级功能扩展"></a>2.6 高级功能扩展</h3><p>​        <em><strong>附加高级功能可能导致运行不稳定，谨慎使用，不使用请关闭</strong></em></p><p>​        MentoHUST暂时用不上，<strong>保持关闭</strong>即可</p><p>​        解锁网易云灰色歌曲打开后连接WiFi可自动解锁，但可能让网易云加载变慢，自行测试使用</p><p>​        UU游戏加速器可登陆自己的账号，自行测试使用</p><p>​        KMS可自动解锁局域网内的Office 365全家桶，自行测试使用</p><p><img src="https://bd076fc.webp.li/2024/11/0b68a04d6deb9a3a5d00c76dd1ee3916.png"></p><h3 id="2-7-接入校园网"><a href="#2-7-接入校园网" class="headerlink" title="2.7 接入校园网"></a>2.7 接入校园网</h3><p>​        <strong>保证<em>2.2—2.6</em>的设置无误</strong>后，再接入已连接校园网的网线到<strong>wan口</strong> <em>（靠近电源线的口）</em></p><p>​        自动弹出或自己1.1.1.1进入认证页面，登陆自己的宽带</p><p>​        宽带有问题请加认证页面左下角群，<strong>自行找管理人员解决</strong></p><p><img src="https://bd076fc.webp.li/2024/11/fd5c2611c0b1ddb8264b11168005ec35.png"></p><h2 id="3-注意事项"><a href="#3-注意事项" class="headerlink" title="3.注意事项"></a>3.注意事项</h2><p>​    被检测到五分钟后会自动恢复正常，或者去校园网系统重新登陆</p><p>​    本路由实测最高连接14台设备没被检测，但是100M宽带建议不超过4台设备，200M宽带建议不超过6台设备</p><p>​    多设备同时接入与断开路由有高机率被检测，比如室友集体下课回寝，集体出去上课时</p><p>​    不建议连接此破解WiFi使用翻墙软件，容易被ban</p><p>​    后期会整理大家使用当中存在的问题尝试出一期解决方案</p>]]></content>
      
      
      <categories>
          
          <category> 路由技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 路由器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2024/11/08/hello-world/"/>
      <url>/2024/11/08/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
